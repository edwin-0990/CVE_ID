# *CVE Writeup: Plaintext Storage of Sensitive Information in KSRTC Karnataka Android Application*

## Overview
This article details the discovery of a critical vulnerability in the KSRTC Karnataka Android application, which involves the insecure storage of sensitive user information in plaintext within shared preferences. The vulnerability exposes user credentials and personal data to potential exploitation, violating mobile security best practices and OWASP Mobile Top 10 guidelines.

## Vulnerability Details
**CVE ID**: CVE-2025-25381

**Vendor**: Karnataka State Road Transport Corporation (KSRTC)

**Affected Application**: KSRTC Karnataka Android Application

**Affected Versions**: 1.4.3 and 1.4.2

**Vulnerability Type**: Insecure Data Storage (OWASP Mobile Top 10: M2)

**Severity**: Critical

**Reported By**: Edwin Shajan

## Vulnerability Description

The KSRTC Karnataka Android application stores sensitive user information, including email IDs, passwords, mobile numbers, and account IDs, in plaintext within shared preferences. Shared preferences are a common mechanism for storing lightweight data in Android applications, but they are not designed for secure storage of sensitive information. This insecure practice allows attackers with access to the device (e.g., via root privileges or malicious apps) to easily extract and misuse this data.

## Steps to Reproduce

 - Install the Application: Download and install the KSRTC Karnataka app (versions 1.4.3 or 1.4.2) from the Google Play Store.

 - Extract the APK: Use a tool like adb or Google Files' APK sharing feature to extract the APK file from the device.

 - Set Up Testing Environment: Load the APK into Android Studio and run it on an Android emulator with root permissions enabled.

 - Log In: Use valid credentials to log into the application.

 - Inspect Shared Preferences: Navigate to the app's shared preferences directory (typically located at ```/data/data/com.ksrtc.awatar.new/shared_prefs/```) and inspect the stored data (```cat microid_file_login.xml```).

 - Observe Plaintext Data: Confirm that sensitive user information, such as email IDs, passwords, mobile numbers, and account IDs, is stored in plaintext.

## Impact

The plaintext storage of sensitive information poses a significant risk to users. If an attacker gains access to the device (e.g., through malware, physical access, or root exploits), they can easily extract this data. The potential consequences include:

 - Unauthorized access to user accounts.

 - Identity theft and misuse of personal information.

 - Compromise of user privacy and security.

This vulnerability directly violates OWASP Mobile Top 10 guidelines, specifically under the category of Insecure Data Storage (M2).

## Proof of Concept (PoC)

A detailed proof of concept (PoC) demonstrating the vulnerability, which highlights the extraction of plaintext credentials and sensitive data from the app's shared preferences, has been provided. You can view the PoC video here: [PoC Video Link](https://github.com/edwin-0990/CVE_ID/blob/main/CVE-2025-25381/KSRTC_1.4.3_Insecure_Data_Storage.mp4).

## Reference
 - https://www.cve.org/CVERecord?id=CVE-2025-25381
 - https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage
---
