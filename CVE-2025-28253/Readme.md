# *CVE-2025-28253: Cross-Site Scripting (XSS) in MainWP MainWP Dashboard*

## Overview
This article highlights the discovery of a Cross-Site Scripting (XSS) vulnerability in the MainWP MainWP Dashboard v5.3.4. The vulnerability resides in class/class-mainwp-post-handler.php, where unsanitized user input from $_POST['sites'], $_POST['clients'], and $_POST['search'] is passed directly into the MainWP_User::render_table function without adequate sanitization. Despite using sanitize_text_field and wp_unslash, the values are still vulnerable to HTML or script injection, allowing an attacker to execute malicious JavaScript.

## Vulnerability Details
**CVE ID**: CVE-2025-28253

**Vendor**: MainWP

**Affected Application**: MainWP Dashboard

**Affected Versions**: 5.3.4

**Vulnerability Type**: Cross-Site Scripting (XSS)

**Severity**: High

**Reported By**: Edwin Shajan

## Vulnerability Description
The vulnerability arises due to improper handling of user-supplied input passed through the following POST parameters:

 - $_POST['sites']

 - $_POST['clients']

 - $_POST['search']

These inputs are sanitized using sanitize_text_field and wp_unslash, but they are directly passed into the MainWP_User::render_table() function without additional sanitization, leading to a Reflected XSS scenario.

## Steps to Reproduce

 1) Login to MainWP Dashboard: Access the MainWP Dashboard as an authenticated user.

 2) Intercept the Request: Use a web proxy like Burp Suite to intercept and modify the POST request sent to the vulnerable endpoint.

 3) Inject Malicious Payload: Modify the values of sites, clients, or search with a malicious JavaScript payload, such as:

    ```html
    <script>alert('XSS');</script>

 4) Send the Modified Request: Forward the request to the server.

 5) Observe Script Execution: Upon rendering the response, the JavaScript payload is executed in the user's browser.


## Vulnerable Code Snippet

  ```html
public function mainwp_users_search() {
    $this->secure_request( 'mainwp_users_search' );
    MainWP_Cache::init_session();

    // phpcs:disable WordPress.Security.NonceVerification,WordPress.Security.ValidatedSanitizedInput.InputNotSanitized
    $role    = isset( $_POST['urole'] ) ? sanitize_text_field( wp_unslash( $_POST['urole'] ) ) : '';
    $groups  = isset( $_POST['groups'] ) && is_array( $_POST['groups'] ) ? array_map( 'sanitize_text_field', wp_unslash( $_POST['groups'] ) ) : '';
    $sites   = isset( $_POST['sites'] ) && is_array( $_POST['sites'] ) ? array_map( 'sanitize_text_field', wp_unslash( $_POST['sites'] ) ) : '';
    $clients = isset( $_POST['clients'] ) && is_array( $_POST['clients'] ) ? array_map( 'sanitize_text_field', wp_unslash( $_POST['clients'] ) ) : '';
    $search  = isset( $_POST['search'] ) ? sanitize_text_field( wp_unslash( $_POST['search'] ) ) : '';
    // phpcs:enable WordPress.Security.NonceVerification,WordPress.Security.ValidatedSanitizedInput.InputNotSanitized

    MainWP_User::render_table( false, $role, $groups, $sites, $search, $clients );
    die();
}    
```

## Impact

- Code Execution: True

- Information Disclosure: True

- Potential Consequences:
  - Execution of malicious scripts within the user's browser.

  - Unauthorized actions on behalf of authenticated users.

  - Theft of sensitive user data, including session tokens and cookies.

## Attack Vectors

The vulnerability is exploitable by submitting malicious input via the HTTP POST request to the MainWP Dashboard's vulnerable endpoint. This can be exploited through:

- Phishing Campaigns: Enticing users to click on malicious links.

- Social Engineering: Tricking an administrator to trigger the XSS payload.

## Mitigation Recommendations

To mitigate this vulnerability:

  1) Use `wp_kses()` or `esc_html()` to sanitize input before rendering it in HTML output.

  2) Validate Input Properly: Ensure that input data passed to `MainWP_User::render_table` is properly sanitized and encoded.

  3) Implement Nonce Verification: Ensure that nonce validation is correctly implemented to mitigate CSRF attacks.


## References

  - [MainWP Official Website](https://mainwp.com/)
  - [MainWP GitHub Repository](https://github.com/mainwp/mainwp/)
  - [Affected Codebase](https://github.com/mainwp/mainwp/blob/5f84a8ff627b5cabb3f7693ee623063b52cdcc5a/class/class-mainwp-post-handler.php#L200)

